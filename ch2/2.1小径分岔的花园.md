<!--
Our goal in this section will be to build Bayesian inference up from humble beginnings, so there is no superstition about it. Bayesian inference is really just counting and comparing of possibilities. Consider by analogy Jorge Luis Borges’ short story “The Garden of Forking Paths.” The story is about a man who encounters a book filled with contradictions. In most books, characters arrive at plot points and must decide among alternative paths. A protagonist may arrive at a man’s home. She might kill the man, or rather take a cup of tea. Only one of these paths is taken—murder or tea. But the book within Borges’ story explores all paths, with each decision branching outward into an expanding garden of forking paths.
-->

&emsp;&emsp;本节我们从头开始建立一个贝叶斯推断，没什么神秘的。贝叶斯推断本来就只是计数和比较可能性的大小。我们可以拿豪尔赫·路易斯·博尔赫斯的短篇小说“[小径分岔的花园](https://www.zhihu.com/question/20776234?sort=created)”做类比。故事讲述的是有个人拿到了一本充满矛盾的书。书中大部分内容是关于主人公到达某个岔路的时候必须选择其中一条路。他可能走到某人的家里，或者杀掉他或者只是一起喝杯茶。并且只能选择或者杀了他或者喝茶。博尔赫斯的故事中探讨了所有的路径，每一个决定都向外走到一个更大的花园。

<!--
This is the same device that Bayesian inference offers. In order to make good inference about what actually happened, it helps to consider everything that could have happened. A Bayesian analysis is a garden of forking data, in which alternative sequences of events are cultivated. As we learn about what did happen, some of these alternative sequences are pruned. In the end, what remains is only what is logically consistent with our knowledge.
-->

&emsp;&emsp;这与贝叶斯推断相同。了解了所有已经发生情况，才能做出正确的推断。贝叶斯分析就是这样一个充满了路径的花园，充满了需要做出选择的序列。如果我们知道了某些事件已经发生，那么就可以排除掉某些路径。最后剩下的就是根据已知情况能够推理出的路径。

<!--
This approach provides a quantitative ranking of hypotheses, a ranking that is maximally conservative, given the assumptions and data that go into it. The approach cannot guarantee a correct answer, on large world terms. But it can guarantee the best possible answer, on small world terms, that could be derived from the information fed into it.
-->

&emsp;&emsp;贝叶斯方法是对各种假设的一个定量排名，一个在给定数据和假设的情况下的极端保守排名。不保证在真实世界的应用中有正确答案。但是在小世界中贝叶斯方法可以保证这是从已知中能够得出的可能性最高的答案。
<!--
Consider the following toy example.
-->
&emsp;&emsp;看一个简单的例子

<!--
2.1.1. Counting possibilities. Suppose there’s a bag, and it contains four marbles. These marbles come in two colors: blue and white. We know there are four marbles in the bag, but we don’t know how many are of each color. We do know that there are five possibilities: (1)[ ],(2)[ ],(3)[ ],(4)[ ],(5)[ ]. Thesearetheonly possibilities consistent with what we know about the contents of the bag. Call these five possibilities the conjectures.
-->
&emsp;&emsp; **2.1.1 概率计数**。假设有一个袋子，里面有四个小球。小球有两种颜色：蓝色和白色。我们只知道袋子里有四个小球但是不知道蓝色和白色分别有多少个。那么就有5种可能：
（1）\[:white_circle::white_circle::white_circle::white_circle:\]，
（2）\[:large_blue_circle::white_circle::white_circle::white_circle:\]，
（3）\[:large_blue_circle::large_blue_circle::white_circle::white_circle:\]，
（4）\[:large_blue_circle::large_blue_circle::large_blue_circle::white_circle:\]，
（5）\[:large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle:\]。袋子里的小球的颜色只有这5种可能。这5个可能性我们叫它推测。

<!--
Our goal is to figure out which of these conjectures is most plausible, given some evi- dence about the contents of the bag. We do have some evidence: A sequence of three mar- bles is pulled from the bag, one at a time, replacing the marble each time and shaking the bag before drawing another marble. The sequence that emerges is: , in that order. These are the data.
-->
&emsp;&emsp; 我们的目标是在已知一些证据的情况下找出哪种组合的可能性最大。我们有一些已知证据：从袋子里随机取三次小球形成的一个数据序列，每次取之前都把已经取出的小球放回去并摇一摇袋子。结果是\(:large_blue_circle::white_circle::large_blue_circle:\)。这就是我们已知的数据。
<!--
So now let’s plant the garden and see how to use the data to infer what’s in the bag. Let’s begin by considering just the single conjecture, [ ], that the bag contains one blue and three white marbles. On the first draw from the bag, one of four things could happen, corre- sponding to one of four marbles in the bag. So we can visualize the possibilities branching outward:
-->
&emsp;&emsp; 我们来画一画这个“花园”，看一下怎么用这些数据来推断袋子里小球的颜色。我们随意选一种推测比如\[:large_blue_circle::white_circle::white_circle::white_circle:\]，袋子里有一个蓝球和三个白球。第一次从袋子取出小球的时候有4种可能。画出来的分支如下图所示：
<p align="center"> <img src="images/ball_path_1.png"  width="200"/> </p>

<!--
Now consider the garden as we get another draw from the bag. It expands the garden out one layer:
-->
现在选第二个球。“花园”展开的样子如下：

<p align="center"> <img src="images/ball_path_2.png"  width="300"/> </p>

<!--
Now there are 16 possible paths through the garden, one for each pair of draws. On the second draw from the bag, each of the paths above again forks into four possible paths. Why?
-->

现在花园有16条可能的路径，每条路径代表取一个小球。第二次取小球的时候，每条路径又扩展出4条新的路径。为什么？
<!--
Because we believe that our shaking of the bag gives each marble a fair chance at being drawn, regardless of which marble was drawn previously. The third layer is built in the same way, and the full garden is shown in Figure 2.2. There are 43 = 64 possible paths in total.
-->
因为每次取小球的时候我们都把以前取出的小球放进去并摇了袋子，取出没个小球的概率相同。第三层的构建也一样，整个花园如图2-2。有4的3次方=64条路径。

<p align="center"> <img src="images/figure2-2.png"  width="500"/> </p>
<p align="center">图2-2 当袋子里有一个蓝球和三个白球时的64种可能</p>
<!--
As we consider each draw from the bag, some of these paths are logically eliminated. The first draw tuned out to be , recall, so the three white paths at the bottom of the garden are eliminated right away. If you imagine the real data tracing out a path through the garden, it must have passed through the one blue path near the origin. The second draw from the bag produces , so three of the paths forking out of the first blue marble remain. As the data trace out a path, we know it must have passed through one of those three white paths (after the first blue path), but we don’t know which one, because we recorded only the color of each marble. Finally, the third draw is . Each of the remaining three paths in the middle layer sustain one blue path, leaving a total of three ways for the sequence to appear, assuming the bag contains [ ]. Figure 2.3 shows the garden again, now with logically eliminated paths grayed out. We can’t be sure which of those three paths the actual data took. But as long as we’re considering only the possibility that the bag contains one blue and three white marbles, we can be sure that the data took one of those three paths. Those are the only paths consistent with both our knowledge of the bag’s contents (four marbles, white or blue) and the data ( ).
-->

&emsp;&emsp; 随着每次从袋子里取出小球，有些路径不合逻辑可以去掉。第一次取出的小球是:large_blue_circle:，所以全是白球的路径就可以去掉。真实的数据如果映射到花园路径上，那么它一定是穿过离起始点最近的那个蓝色小球。第二次取小球以后从第一个蓝球衍生出的三条路径保留了下来。我们的数据一定是一个蓝球后的三个白球的路径之一，但是并不知道到底是哪一条路径，因为每次只记录的小球的颜色。最后第三次取出的小球是:large_blue_circle:，每条前面剩下的路径只衍生出一条路径，所以最后有三条路径可以出现我们想要的序列:large_blue_circle::white_circle::large_blue_circle:，这里我们假设袋子里的小球是\[:large_blue_circle::white_circle::white_circle::white_circle:\]。图2-3把一些不可能的路径去掉又重新展示了一下可能的路径，现在我们无法确定到底走的是那条路径。但是因为我们只想知道袋子里有一个蓝球和三个白球的概率，所以可以肯定是其中一条路径。这三条路径就是我们根据已知（袋子里包含4个小球，白色或蓝色）和数据（:large_blue_circle::white_circle::large_blue_circle:）所能得出的结果。

<p align="center"> <img src="images/figure2-3.png"  width="500"/> </p>
<p align="center">图2-3 把与数据冲突的路径取掉，只剩下3条可能的路径</p>

<!--
This demonstrates that there are three (out of 64) ways for a bag containing [ ] to produce the data . We have no way to decide among these three ways. The infer- ential power comes from comparing this count to the numbers of ways each of the other conjectures of the bag’s contents could produce the same data. For example, consider the conjecture [ ]. There are zero ways for this conjecture to produce the observed data, because even one is logically incompatible with it. The conjecture [ ] is likewise logically incompatible with the data. So we can eliminate these two conjectures, because neither provides even a single path that is consistent with the data.
-->

&emsp;&emsp;也就是说如果袋子里的小球是\[:large_blue_circle::white_circle::white_circle::white_circle:\]，那么有3(总共64)种方法得到数据:large_blue_circle::white_circle::large_blue_circle:。我们没法确定这三种方法中确切的一种。推断的强大之处在于可以对比袋子里小球每种可能的组合之间可以产生上述数据的可能的的多少。比如\[:white_circle::white_circle::white_circle::white_circle:\]可能的方法就是0。\[:large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle:\]可能的方法也是0。所以这两种组合我们可以排除了，因为没有一条路径可以产生我们已经观察到的数据。

<!--
Figure 2.4 displays the full garden now, for the remaining three conjectures: [ ], [ ], and [ ]. The upper-left wedge displays the same garden as Figure 2.3. The upper-right shows the analogous garden for the conjecture that the bag contains three blue marbles and one white marble. And the bottom wedge shows the garden for two blue and two white marbles. Now we count up all of the ways each conjecture could produce the observed data. For one blue and three white, there are three ways, as we counted already. For two blue and two white, there are eight paths forking through the garden that are logically consistent with the observed sequence. For three blue and one white, there are nine paths that survive.
-->

&emsp;&emsp;图2-4展示了完整的花园，包括\[:large_blue_circle::white_circle::white_circle::white_circle:\]，\[:large_blue_circle::large_blue_circle::white_circle::white_circle:\]和\[:large_blue_circle::large_blue_circle::large_blue_circle::white_circle:\]。图的左上角与图2-3相同。右上角展示的是当袋子里有三个蓝球和一个白球的样子。图的下半部分展示的是两个白球和两个蓝球时的样子。我们数一下每种组合产生观测数据的方法数。一个蓝球和三个白球的时候有三条路径。两个蓝球和两个白球的时候有八条路径产生我们的观测数据。三个蓝球和一个白球的时候有九条路径。

<p align="center"> <img src="images/figure2-4.png"  width="500"/> </p>
<p align="center">图2-4 所有可能的组合可以产生已知数据的路径情况</p>

<!--
To summarize, we’ve considered five different conjectures about the contents of the bag, ranging from zero blue marbles to four blue marbles. For each of these conjectures, we’ve counted up how many sequences, paths through the garden of forking data, could potentially produce the observed data, :
-->

总结一下，我们把零个蓝球到四个蓝球的所有的组合情况都列出来。表中列出来所有可以产生观测数据的路径个数：

|   组合       |产生已知数据的路径数|
|-------------|-----------------|
|\[:white_circle::white_circle::white_circle::white_circle:\]|0 x 4 x 0 = 0|
|\[:large_blue_circle::white_circle::white_circle::white_circle:\]|1 x 3 x 1 = 3|
|\[:large_blue_circle::large_blue_circle::white_circle::white_circle:\]|2 x 2 x 2 = 8|
|\[:large_blue_circle::large_blue_circle::large_blue_circle::white_circle:\]|3 x 1 x 3 = 9|
|\[:large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle:\]|4 x 0 x 4 = 0|


<!--
Notice that the number of ways to produce the data, for each conjecture, can be computed by first counting the number of paths in each “ring” of the garden and then by multiplying these counts together. This is just a computational device. It tells us the same thing as Fig- ure 2.4, but without having to draw the garden. The fact that numbers are multiplied during calculation doesn’t change the fact that this is still just counting of logically possible paths. This point will come up again, when you meet the more formal representation of Bayesian inference.
-->
&emsp;&emsp;注意,每种组合产生观测数据的路径数量的就是数一下花园每个环上的路径数量，然后乘到一起就可以了。这就是个计算工具。结果跟图2-4一样，但却不用把整个花园都画出来。即使是乘法也改变不了我们只是数了数可能的路径的事实。后面讲贝叶斯推断更正式的表达时也是这样的。

<!--
So what good are these counts? By comparing these counts, we have part of a solution for a way to rate the relative plausibility of each conjectured bag composition. But it’s only a part of a solution, because in order to compare these counts we first have to decide how many ways each conjecture could itself be realized. We might argue that when we have no reason to assume otherwise, we can just consider each conjecture equally plausible and compare the counts directly. But often we do have reason to assume otherwise.
-->

&emsp;&emsp;这样的技术计算有什么好处呢？比较这些计数，起码我们有方法比较多种组合之间的可能性。但是这只能叫做一部分方法，因为必须得知道每种组合出现的概率大小。大家可能会说每种组合概率都相同直接比较数量就可以了。但是实际情况通常不是这样的。

<!--
Rethinking: Justification. Using these counts of paths through the garden as measures of relative plausibility can be justified in several ways. The justification here is logical: If we wish to reason about plausibility and remain consistent with ordinary logic—statements about true and false—then we should obey this procedure.39 There are several other justifications that lead to the same mathe- matical procedure. Regardless of how you choose to philosophically justify it, notice that it actually works. Justifications and philosophy motivate procedures, but it is the results that matter. The many successful real world applications of Bayesian inference may be all the justification you need. Twen- tieth century opponents of Bayesian data analysis argued that Bayesian inference was easy to justify, buthardtoapply.40 Thatisluckilynolongertrue.JustbecarefulnottoassumethatbecauseBayesian inference is justified that no other approach can also be justified. Golems come in many types, and some of all types are useful.
-->

>思考：证明。用类似这种花园路径的方式来度量可能性，有若干种证明方法。这里我们逻辑上证明一下：如果我们想要归因可能性并保留原来的逻辑，真假陈述，我们就能得到这个过程。还有好几种证明方法可以得到同样的数学过程。不管你怎么证明，总之它很有效。可能大家需要看到的证明方式是贝叶斯推断在真实世界中的成功应用。20世纪贝叶斯分析的反对者认为贝叶斯推断证明容易但是很难有实际应用。但是很幸运这不再是真的了，没有其他方法也可以证明它很有用，石人有很多种，有一些非常有用。
